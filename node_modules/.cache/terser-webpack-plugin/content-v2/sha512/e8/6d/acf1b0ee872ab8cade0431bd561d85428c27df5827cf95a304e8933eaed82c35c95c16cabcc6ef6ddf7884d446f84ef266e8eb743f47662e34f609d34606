{"code":"!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,\"a\",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p=\"\",i(i.s=6)}([function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=i(1),r=i(3);t.CANVAS=document.querySelector(\"canvas\"),t.CTX=t.CANVAS.getContext(\"2d\"),t.SPAWN_LOCATION=r.getUniquePosition(n.level01.map,2),t.HEADQUARTERS=r.getUniquePosition(n.level01.map,3),t.TILE_SIZE=50,t.STARTING_MONEY=200,t.STARTING_HQ_HEALTH=20,t.WAVE_NUM_DIV=document.querySelector(\".wave-num\"),t.COIN_NUM_DIV=document.querySelector(\".coin-num\"),t.FAST_FORWARD_DIV=document.querySelector(\".fast-forward\"),t.BOTTOM_BAR_DIV=document.querySelector(\".bottom-bar\")},function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=i(0),r=i(2);t.level01={map:[[0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,1,1,1,0,0,0,0,0],[0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0],[0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0],[0,0,1,1,1,1,1,1,1,0,1,1,1,1,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],waves:[{amount:15,type:\"normal\"},{amount:20,type:\"normal\"},{amount:15,type:\"heavy\"},{amount:20,type:\"heavy\"}]},t.renderMap=function(e){n.CTX.fillStyle=\"black\",n.CTX.fillRect(0,0,e[0].length*n.TILE_SIZE,e.length*n.TILE_SIZE),e.forEach((function(e,t){e.forEach((function(e,i){e>0&&e<4&&(n.CTX.fillStyle=\"#444\",n.CTX.fillRect(i*n.TILE_SIZE,t*n.TILE_SIZE,n.TILE_SIZE,n.TILE_SIZE))}))}))},t.renderBuildings=function(e){e.forEach((function(e,t){e.forEach((function(e,i){2===e&&(n.CTX.fillStyle=\"#222\",n.CTX.fillRect(i*n.TILE_SIZE,t*n.TILE_SIZE,n.TILE_SIZE,n.TILE_SIZE),n.CTX.font=\"20px monospace\",n.CTX.fillStyle=\"white\",n.CTX.textAlign=\"center\",n.CTX.fillText(\"S\",i*n.TILE_SIZE+.5*n.TILE_SIZE,t*n.TILE_SIZE+.6*n.TILE_SIZE)),3===e&&(n.CTX.fillStyle=\"#222\",n.CTX.fillRect(i*n.TILE_SIZE,t*n.TILE_SIZE,n.TILE_SIZE,n.TILE_SIZE),n.CTX.font=\"20px monospace\",n.CTX.fillStyle=\"white\",n.CTX.textAlign=\"center\",n.CTX.fillText(r.hqHealth.value.toString(),i*n.TILE_SIZE+.5*n.TILE_SIZE,t*n.TILE_SIZE+.6*n.TILE_SIZE))}))}))}},function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=i(0),r=i(1);t.id={value:0,get:function(){return this.value++}},t.money={value:null,set:function(e){this.value=e,this.updateUI()},increaseBy:function(e){this.value+=e,this.updateUI()},decreaseBy:function(e){this.value-=e,this.updateUI()},updateUI:function(){n.COIN_NUM_DIV.innerHTML=this.value.toString()}},t.hqHealth={value:null,set:function(e){this.value=e},decrease:function(){this.value--}},t.waves={value:null,set:function(e){this.value=e,this.updateUI()},increase:function(){this.value++,this.updateUI()},updateUI:function(){n.WAVE_NUM_DIV.innerHTML=(this.value+1).toString()+\" / \"+r.level01.waves.length}},t.construction={displayPreview:!1,position:null,blueprint:null,showPreview:function(){this.displayPreview=!0},hidePreview:function(){this.displayPreview=!1},setPosition:function(e){this.position=e},setBlueprint:function(e){this.blueprint=e}},t.mouse={position:null,setPosition:function(e){this.position=e}},t.game={isPaused:!1,isFastForward:!1,isGameOver:!1,togglePaused:function(){this.isPaused=!this.isPaused},toggleFastForward:function(){this.isFastForward=!this.isFastForward},toggleGameOver:function(){this.isGameOver=!this.isGameOver}}},function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getUniquePosition=function(e,t){var i,n;return e.forEach((function(e,r){e.includes(t)&&(n=r,i=e.indexOf(t))})),{x:i,y:n}},t.getValueAtPosition=function(e,t){var i=e.x,n=e.y;return t[n]?t[n][i]:null},t.arePositionsEqual=function(e,t){return Object.keys(e).length===Object.keys(t).length&&Object.keys(e).every((function(i){return e[i]===t[i]}))},t.getAdjacentPositions=function(e,i){return[{x:e.x-1,y:e.y},{x:e.x+1,y:e.y},{x:e.x,y:e.y-1},{x:e.x,y:e.y+1}].filter((function(e){return t.getValueAtPosition(e,i)>0&&t.getValueAtPosition(e,i)<4}))},t.positionToId=function(e){return e.x+1e3*e.y},t.breadthFirstSearch=function(e){var i=e.map,n=e.start,r=e.end,o=new Set,a=[];a.push({position:n,path:[]});for(var l=function(){var e=a.shift(),n=e.position,l=e.path;if(t.arePositionsEqual(n,r))return{value:l};o.has(t.positionToId(n))||(o.add(t.positionToId(n)),t.getAdjacentPositions(n,i).forEach((function(e){a.push({position:e,path:l.concat([e])})})))};a.length;){var s=l();if(\"object\"==typeof s)return s.value}return[]},t.areColliding=function(e,t){var i=e.position.x-t.position.x,n=e.position.y-t.position.y;return Math.sqrt(i*i+n*n)<e.radius+t.radius},t.move=function(e,t,i){var n=i/100;return e.x<t.x?{x:Number((e.x+=n).toFixed(4)),y:e.y}:e.x>t.x?{x:Number((e.x-=n).toFixed(4)),y:e.y}:e.y<t.y?{x:e.x,y:Number((e.y+=n).toFixed(4))}:e.y>t.y?{x:e.x,y:Number((e.y-=n).toFixed(4))}:void 0}},function(e,t,i){\"use strict\";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,\"__esModule\",{value:!0});var r=i(0),o=i(7),a=i(1),l=i(2),s=i(5),u=i(8),c=i(3),f=i(9),v=0,E=0;t.finishLevel=function(){console.log(\"level won!\")};var d=function(){++v%30==0&&a.level01.waves[l.waves.value]&&a.level01.waves[l.waves.value].amount&&(a.level01.waves[l.waves.value].amount--,o.activeEnemies.push(n(n({},o.enemyBlueprints.find((function(e){return e.type===a.level01.waves[l.waves.value].type}))),{id:l.id.get(),isUnderFire:!1,position:c.getUniquePosition(a.level01.map,2),route:c.breadthFirstSearch({end:r.HEADQUARTERS,map:a.level01.map,start:r.SPAWN_LOCATION})}))),a.level01.waves[l.waves.value].amount<1&&++E%1e3==0&&(l.waves.value<a.level01.waves.length-1&&l.waves.increase(),E=0),o.updateEnemies(o.activeEnemies),s.updateTowers(s.towers,o.activeEnemies)},I=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},T=I(),h=0;t.frame=function(){var e=I(),i=l.game.isFastForward?1/240:1/60;for(h+=Math.min(1,(e-T)/1e3);h>i;)h-=i,l.game.isPaused||l.game.isGameOver||d();T=e,a.renderMap(a.level01.map),s.renderTowers(s.towers),o.renderEnemies(o.activeEnemies),s.renderConstructionPreview(),a.renderBuildings(a.level01.map),l.hqHealth.value<=0&&(console.log(\"game over!\"),l.game.toggleGameOver()),requestAnimationFrame(t.frame)};t.startGame=function(){var e;(e=r.CANVAS).width=a.level01.map[0].length*r.TILE_SIZE,e.style.width=a.level01.map[0].length*r.TILE_SIZE+\"px\",e.height=a.level01.map.length*r.TILE_SIZE,e.style.height=a.level01.map.length*r.TILE_SIZE+\"px\",f.registerEventHandlers(),u.initializeUI(),l.money.set(r.STARTING_MONEY),l.hqHealth.set(r.STARTING_HQ_HEALTH),l.waves.set(0),requestAnimationFrame(t.frame)}},function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=i(0),r=i(1),o=i(2),a=i(3);t.towerBlueprints=[{type:\"turret\",damagePerFrame:1,radius:1.5,cost:100,color:\"blue\"},{type:\"flamethrower\",damagePerFrame:2,radius:1.2,cost:150,color:\"red\"}],t.updateTowers=function(e,t){e.forEach((function(e){e.isFiring=!1;var i=[];if(t.forEach((function(t){a.areColliding(e,t)&&i.push(t)})),i.sort((function(e,t){return e.id-t.id})),i.length){e.isFiring=!0;var n=e.damagePerFrame,r=i[0];r.isUnderFire=!0,r.health-=n}}))},t.renderTowers=function(e){e.forEach((function(e){var t=e.position,i=e.isFiring,r=t.x,o=t.y;n.CTX.fillStyle=e.color,n.CTX.fillRect(r*n.TILE_SIZE+10,o*n.TILE_SIZE+10,n.TILE_SIZE-20,n.TILE_SIZE-20),i&&(n.CTX.fillStyle=\"white\",n.CTX.beginPath(),n.CTX.arc(r*n.TILE_SIZE+.5*n.TILE_SIZE,o*n.TILE_SIZE+.5*n.TILE_SIZE,5,0,2*Math.PI),n.CTX.fill())}))},t.renderConstructionPreview=function(){var e=o.construction.displayPreview,t=o.construction.blueprint;if(t){var i=t.cost,l=t.color,s=t.radius,u=o.mouse.position,c=o.money.value;e&&u&&0===a.getValueAtPosition(u,r.level01.map)&&i<=c&&(n.CTX.fillStyle=\"rgba(255,255,255,.1)\",n.CTX.beginPath(),n.CTX.arc(u.x*n.TILE_SIZE+.5*n.TILE_SIZE,u.y*n.TILE_SIZE+.5*n.TILE_SIZE,s*n.TILE_SIZE,0,2*Math.PI),n.CTX.fill(),n.CTX.fillStyle=l,n.CTX.fillRect(u.x*n.TILE_SIZE+10,u.y*n.TILE_SIZE+10,n.TILE_SIZE-20,n.TILE_SIZE-20)),i>c&&o.construction.hidePreview()}},t.towers=[]},function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),i(4).startGame()},function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=i(0),r=i(4),o=i(1),a=i(2),l=i(3);t.updateEnemies=function(e){e.forEach((function(t){var i=t.position,s=t.route,u=t.health,c=t.reward,f=t.speed;if(u<=0&&a.money.increaseBy(c),l.arePositionsEqual(i,n.HEADQUARTERS)&&a.hqHealth.decrease(),l.arePositionsEqual(i,n.HEADQUARTERS)||u<=0)return e.splice(e.indexOf(t),1),a.waves.value===o.level01.waves.length-1&&0===e.length&&r.finishLevel(),null;l.arePositionsEqual(i,s[0])&&s.shift(),t.position=l.move(i,s[0],f),t.isUnderFire=!1}))},t.renderEnemies=function(e){e.forEach((function(e){var t=e.position,i=e.isUnderFire,r=e.health,o=e.originalHealth,a=e.color;n.CTX.fillStyle=i?\"white\":a,n.CTX.beginPath(),n.CTX.arc(t.x*n.TILE_SIZE+.5*n.TILE_SIZE,t.y*n.TILE_SIZE+.5*n.TILE_SIZE,5,0,2*Math.PI),n.CTX.fill(),r/o<1&&(n.CTX.fillStyle=\"black\",n.CTX.fillRect(t.x*n.TILE_SIZE+17.5,t.y*n.TILE_SIZE+35,15,2),n.CTX.fillStyle=\"lime\",n.CTX.fillRect(t.x*n.TILE_SIZE+17.5,t.y*n.TILE_SIZE+35,r/o*15,2))}))},t.enemyBlueprints=[{type:\"normal\",color:\"red\",radius:.05,originalHealth:75,health:75,reward:2,speed:2.5,intervalInTicks:30},{type:\"heavy\",color:\"pink\",radius:.05,originalHealth:150,health:150,reward:3,speed:2,intervalInTicks:25}],t.activeEnemies=[]},function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=i(0),r=i(5);t.initializeUI=function(){r.towerBlueprints.forEach((function(e){n.BOTTOM_BAR_DIV.innerHTML+=\"<div class='tower-slot \"+e.type+'\\'><div class=\"preview\" style=\"background: '+e.color+'\"/></div>'}))}},function(e,t,i){\"use strict\";this&&this.__assign;Object.defineProperty(t,\"__esModule\",{value:!0});i(4),i(0),i(1),i(2),i(5),i(3);t.registerEventHandlers=function(){}}]);","extractedComments":[]}