{"code":"!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=2)}([function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(3),o=n(1);t.CANVAS=document.querySelector(\"canvas\"),t.CTX=t.CANVAS.getContext(\"2d\"),t.SPAWN_LOCATION=o.getUniquePosition(i.level01.map,2),t.HEADQUARTERS=o.getUniquePosition(i.level01.map,3),t.TILE_SIZE=50,t.STARTING_MONEY=200,t.STARTING_HEALTH=20},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getUniquePosition=function(e,t){var n,i;return e.forEach((function(e,o){e.includes(t)&&(i=o,n=e.indexOf(t))})),{x:n,y:i}},t.getValueAtPosition=function(e,t){var n=e.x,i=e.y;return t[i]?t[i][n]:null},t.arePositionsEqual=function(e,t){return Object.keys(e).length===Object.keys(t).length&&Object.keys(e).every((function(n){return e[n]===t[n]}))},t.getAdjacentPositions=function(e,n){return[{x:e.x-1,y:e.y},{x:e.x+1,y:e.y},{x:e.x,y:e.y-1},{x:e.x,y:e.y+1}].filter((function(e){return t.getValueAtPosition(e,n)>0&&t.getValueAtPosition(e,n)<4}))},t.positionToId=function(e){return e.x+1e3*e.y},t.breadthFirstSearch=function(e){var n=e.map,i=e.start,o=e.end,r=new Set,l=[];l.push({position:i,path:[]});for(var a=function(){var e=l.shift(),i=e.position,a=e.path;if(t.arePositionsEqual(i,o))return{value:a};r.has(t.positionToId(i))||(r.add(t.positionToId(i)),t.getAdjacentPositions(i,n).forEach((function(e){l.push({position:e,path:a.concat([e])})})))};l.length;){var u=a();if(\"object\"==typeof u)return u.value}return[]},t.areColliding=function(e,t){var n=e.position.x-t.position.x,i=e.position.y-t.position.y;return Math.sqrt(n*n+i*i)<e.radius+t.radius}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(0),o=n(6),r=n(3),l=n(5),a=n(1),u=0;t.money={value:i.STARTING_MONEY,increaseBy:function(e){this.value+=e,console.log(this.value)},decreaseBy:function(e){this.value-=e,console.log(this.value)}},t.hqHealth={value:i.STARTING_HEALTH,decrease:function(){this.value--}},t.waves={value:0,increase:function(){this.value++}};i.CANVAS.addEventListener(\"mousemove\",(function(e){var n=e.offsetX,o=e.offsetY,l={x:Math.floor(n/i.TILE_SIZE),y:Math.floor(o/i.TILE_SIZE)};0===a.getValueAtPosition(l,r.level01.map)&&t.money.value>=100?hoverTile=l:hoverTile=null})),i.CANVAS.addEventListener(\"mouseleave\",(function(){hoverTile=null})),i.CANVAS.addEventListener(\"click\",(function(){hoverTile&&(t.money.decreaseMoney(100),r.level01.map[hoverTile.y][hoverTile.x]=4,l.towers.push({damagePerFrame:1,id:u++,isFiring:!1,position:hoverTile,radius:1.5}))})),o.startGame()},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(2),o=n(0);t.level01={map:[[0,0,0,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,0,0,0,0,0,0],[0,1,0,0,0,1,0,0,1,1,1,0],[0,1,0,0,0,1,0,0,1,0,1,0],[0,1,0,0,0,1,0,0,1,0,1,0],[0,1,0,0,0,1,1,1,1,0,1,0],[0,1,0,0,0,0,0,0,0,0,1,0],[0,2,0,0,0,0,0,0,0,0,3,0]],waves:[{amount:15,health:50},{amount:15,health:100},{amount:15,health:150},{amount:15,health:200},{amount:15,health:250}]},t.renderMap=function(e){o.CTX.fillStyle=\"black\",o.CTX.fillRect(0,0,e[0].length*o.TILE_SIZE,e.length*o.TILE_SIZE),e.forEach((function(e,t){e.forEach((function(e,n){e>0&&e<4&&(o.CTX.fillStyle=\"#444\",o.CTX.fillRect(n*o.TILE_SIZE,t*o.TILE_SIZE,o.TILE_SIZE,o.TILE_SIZE)),3===e&&(o.CTX.fillStyle=\"#222\",o.CTX.fillRect(n*o.TILE_SIZE,t*o.TILE_SIZE,o.TILE_SIZE,o.TILE_SIZE),o.CTX.font=\"20px monospace\",o.CTX.fillStyle=\"white\",o.CTX.textAlign=\"center\",o.CTX.fillText(i.hqHealth.value.toString(),n*o.TILE_SIZE+.5*o.TILE_SIZE,t*o.TILE_SIZE+.6*o.TILE_SIZE))}))}))}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(2),o=n(0),r=n(1);t.move=function(e,t){return e.x<t.x?{x:Number((e.x+=.02).toFixed(4)),y:e.y}:e.x>t.x?{x:Number((e.x-=.02).toFixed(4)),y:e.y}:e.y<t.y?{x:e.x,y:Number((e.y+=.02).toFixed(4))}:e.y>t.y?{x:e.x,y:Number((e.y-=.02).toFixed(4))}:void 0},t.updateEnemies=function(e){e.forEach((function(n){var l=n.position,a=n.route,u=n.health,s=n.reward;if(u<=0&&i.money.increaseMoney(s),r.arePositionsEqual(l,o.HEADQUARTERS)&&i.hqHealth.decreaseHealth(),r.arePositionsEqual(l,o.HEADQUARTERS)||u<=0)return e.splice(e.indexOf(n),1),null;r.arePositionsEqual(l,a[0])&&a.shift(),n.position=t.move(l,a[0]),n.isUnderFire=!1}))},t.renderEnemies=function(e){e.forEach((function(e){var t=e.position,n=e.isUnderFire,i=e.health,r=e.originalHealth;o.CTX.fillStyle=n?\"white\":\"red\",o.CTX.beginPath(),o.CTX.arc(t.x*o.TILE_SIZE+.5*o.TILE_SIZE,t.y*o.TILE_SIZE+.5*o.TILE_SIZE,5,0,2*Math.PI),o.CTX.fill(),i/r<1&&(o.CTX.fillStyle=\"black\",o.CTX.fillRect(t.x*o.TILE_SIZE+17.5,t.y*o.TILE_SIZE+35,15,2),o.CTX.fillStyle=\"lime\",o.CTX.fillRect(t.x*o.TILE_SIZE+17.5,t.y*o.TILE_SIZE+35,i/r*15,2))}))},t.enemies=[]},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(0),o=n(1);t.updateTowers=function(e,t){e.forEach((function(e){e.isFiring=!1;var n=[];if(t.forEach((function(t){o.areColliding(e,t)&&n.push(t)})),n.sort((function(e,t){return e.id-t.id})),n.length){e.isFiring=!0;var i=e.damagePerFrame,r=n[0];r.isUnderFire=!0,r.health-=i}}))},t.renderTowers=function(e){e.forEach((function(e){var t=e.position,n=e.isFiring,o=t.x,r=t.y;i.CTX.fillStyle=\"blue\",i.CTX.fillRect(o*i.TILE_SIZE+10,r*i.TILE_SIZE+10,i.TILE_SIZE-20,i.TILE_SIZE-20),n&&(i.CTX.fillStyle=\"white\",i.CTX.beginPath(),i.CTX.arc(o*i.TILE_SIZE+.5*i.TILE_SIZE,r*i.TILE_SIZE+.5*i.TILE_SIZE,5,0,2*Math.PI),i.CTX.fill())}))},t.renderHoverTile=function(e){e&&(i.CTX.fillStyle=\"rgba(255,255,255,.1)\",i.CTX.beginPath(),i.CTX.arc(e.x*i.TILE_SIZE+.5*i.TILE_SIZE,e.y*i.TILE_SIZE+.5*i.TILE_SIZE,75,0,2*Math.PI),i.CTX.fill(),i.CTX.fillStyle=\"rgba(0,0,255,0.4)\",i.CTX.fillRect(e.x*i.TILE_SIZE+10,e.y*i.TILE_SIZE+10,i.TILE_SIZE-20,i.TILE_SIZE-20))},t.towers=[]},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(0),o=n(4),r=n(2),l=n(3),a=n(5),u=n(1),s=0,c=null,f=r.waves.value,E=r.waves.increase,T=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},d=(T(),function(){var e=T();++s%30==0&&l.level01.waves[f]&&l.level01.waves[f].amount&&(l.level01.waves[f].amount--,1===l.level01.waves[f].amount&&setTimeout((function(){E(),console.log(\"Wave \"+(f+1)+\"!\")}),1e4),o.enemies.push({originalHealth:l.level01.waves[f].health,health:l.level01.waves[f].health,id:enemyId++,isUnderFire:!1,position:u.getUniquePosition(l.level01.map,2),radius:.05,reward:5,route:u.breadthFirstSearch({end:i.HEADQUARTERS,map:l.level01.map,start:i.SPAWN_LOCATION})})),o.updateEnemies(o.enemies),a.updateTowers(a.towers,o.enemies),l.renderMap(l.level01.map),a.renderTowers(a.towers),o.renderEnemies(o.enemies),a.renderHoverTile(c),e,requestAnimationFrame(d)});i.CANVAS.addEventListener(\"mousemove\",(function(e){var t=e.offsetX,n=e.offsetY,o={x:Math.floor(t/i.TILE_SIZE),y:Math.floor(n/i.TILE_SIZE)};c=0===u.getValueAtPosition(o,l.level01.map)&&r.money.value>=100?o:null})),i.CANVAS.addEventListener(\"mouseleave\",(function(){c=null})),i.CANVAS.addEventListener(\"click\",(function(){c&&(r.money.decreaseMoney(100),l.level01.map[c.y][c.x]=4,a.towers.push({damagePerFrame:1,id:towerId++,isFiring:!1,position:c,radius:1.5}))})),t.startGame=function(){i.CANVAS.width=l.level01.map[0].length*i.TILE_SIZE,i.CANVAS.style.width=l.level01.map[0].length*i.TILE_SIZE+\"px\",i.CANVAS.height=l.level01.map.length*i.TILE_SIZE,i.CANVAS.style.height=l.level01.map.length*i.TILE_SIZE+\"px\",requestAnimationFrame(d)}}]);","extractedComments":[]}